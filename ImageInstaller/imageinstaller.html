<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
       
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <title>GigaMall</title>
    <style>
    
   .dev {
  
  border: 3px solid green;
} 




/* Style the buttons */
.bt{
	height:45px;
	line-height:45px;
	font-size:20px;
	margin:0 auto;
	text-align:center;
	cursor:pointer;
  border-radius:15px;
	background-color: #003D99 !important;
	background: -webkit-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,0.2) 100%);
  color: #FFFFFF!important;
}

.btn1 {
  border: none;
  outline: none;
  padding: 12px 16px;
  background-color: #f1f1f1;
  cursor: pointer;
  onclick
}

.btn1:hover {
  background-color: #ddd;
}

.btn1.active {
  background-color: #666;
  color: white;
}


.grid-container {
  display: grid;
  grid-template-columns: auto auto;
  grid-gap: 1px;
  
  padding: 1px;
}

.grid-container > div {
  
  
  text-align: center;
  font-size: 20px;
}

    
    <!MODEL!>
    
.modal-header{
  background-color:#212529;
  color:white;
  text-transform:uppercase;
}
.modal-body{
  
  color:black;
  text-align:justify;
}
.btn-color{
  background-color:#D56B1F;
  color:white;
}
.modal-footer{
  
  
  height:60px;
}
#collapse in show{
  height:450px;
}
.modal-body{
  font-size:18px;
  opacity:0.8;
  
}
    
    <!ANalysis!>
#analysis {
  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

#analysis td, #analysis th {
  
  padding: 8px;
  border: 1px solid black;
  border-collapse: collapse;
}



#analysis tr:hover {background-color: #ddd;}

#analysis th {
  padding-top: 12px;
  padding-bottom: 12px;
  text-align: left;
  background-color: #FF6900;
  color: white;
  border: 1px solid black;
  border-collapse: collapse;
}

#Daemon {
  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
  border-collapse: collapse;
  width: 70%;
}

#Daemon td, #Daemon th {
  
  padding: 8px;
  border: 1px solid black;
  border-collapse: collapse;
}



#Daemon tr:hover {background-color: #ddd;}

#Daemon th {
  padding-top: 12px;
  padding-bottom: 12px;
  text-align: left;
  background-color: #FF6900;
  color: white;
  border: 1px solid black;
  border-collapse: collapse;
}

    
    </style>
  </head>
  <body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="overview">System Overview</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="devicereservation">Device Reservation <span class="sr-only">(current)</span></a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="imageinstaller.html">Image Installator</a>
            </li>
            
            <li class="nav-item active" id="LA">
                <a class="nav-link" href="draft.html">Log Analyzer</a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="trafficanalyzer">Traffic Analyzer</a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="trafficgenerator">Traffic Generator</a>
            </li>

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Debug
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="#">Trouble Shoot</a>
                <a class="dropdown-item" href="#">Diagnostics</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#">Something else here</a>
              </div>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="contact"> Contact </a>
            </li>
          </ul>
          <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
          </form>
        </div>
      </nav>
      
      


   
    
 
     
    
     
     
    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

    <!-- Option 2: jQuery, Popper.js, and Bootstrap JS
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    -->
  
  
  

<h2 class="text-center my-4">Enter the device details</h2>

<div class="container positive-relative">
    
      
        <div class="form-row">
            <div class="form-group col-md-2">
                <label for="deviceIpAddress">SSH IP Address</label>
                <input type="text" class="form-control" id="deviceIpAddress" name="deviceIpAddress" placeholder="10.120.6.160">
            </div>
            
            <div class="form-group col-md-2">
                <label for="password">Password</label>
                <input type="password" class="form-control" id="password" name="password" placeholder="gigamon123A!!">
            </div>
            <div class="form-group col-md-2">
                <label for="deviceType">Device Type</label>
                <select id="deviceType" class="form-control" , name="deviceType">
                    <option selected>Select Device</option>
                    <option>HB1</option>
                    <option>HC1</option>
                    <option>HC2</option>
                    <option>HC2PLUS</option>
                    <option>HC3</option>
                    <option>HC3V2</option>
                    <option>TA10</option>
                    <option>TA40</option>
                    <option>TA100</option>
                    <option>TA200</option>
                    <option>dell4112</option>
                </select>
            </div>
            <div class="form-group col-md-2 text-center">
                <label for="deviceType">For Multiple devices</label>
                <button id="dev_btn" type="submit" class="btn btn-success" onclick="addRow()">Add Device</button>
            </div>
        </div>

    
</div>
<br>
<hr>
<br>

<div class="container">
    <h2 class="text-center my-2">Enter the Image details</h2>
    
        
        <div class="form-row">
            <div class="form-group col-md-2">
                <input type="text" class="form-control" name="build" id="build" placeholder="build#">
            </div>
        </div>
        <div class="form-group" id="branch_name">
            <label for="text mx-10">Select Branch Name</label>
            <input class="form-check-input mx-2" type="radio" name="branchName" id="branchName" value="Master" checked>
            <label class="form-check-label col-md-1 mx-4" for="branchName">
                Master
            </label>
            <td></td>
            <input class="form-check-input mx-1" type="radio" name="branchName" id="branchName" value="CI" >
            <label class="form-check-label  col-md-1 mx-4" for="branchName">
                CI
            </label>
            <td></td>
            <input class="form-check-input " type="radio" name="branchName" id="branchName" value="Release" >
            <label class="form-check-label" for="branchName">
                Release
            </label>
        </div>
        <div class="form-group" id="image_type">
            <label for="text mx-10">Select Image Type</label>
            <input class="form-check-input mx-2" type="radio" name="imageType" id="imageType" value="Debug" checked>
            <label class="form-check-label col-md-1 mx-4" for="imageType">
                Debug
            </label>
            <td></td>
            <input class="form-check-input " type="radio" name="imageType" id="imageType" value="Release">
            <label class="form-check-label" for="imageType">
                Release
            </label>
        </div>

        <div class="form-group" id="reset_fact">
            <label for="text mx-10">Reset Factory All :</label>
            <input class="form-check-input mx-2" type="radio" name="resetFactoryAll" id="resetFactoryAll" value="Yes" checked>
            <label class="form-check-label col-md-1 mx-4" for="resetFactoryAll">
                Yes
            </label>
            <td></td>
            <input class="form-check-input" type="radio" name="resetFactoryAll" id="resetFactoryAll" value="No">
            <label class="form-check-label" for="resetFactoryAll">
                No
            </label>
        </div>
  
    <div class="container text-center">
        <button id="up" type="submit" onclick="image_upgrade()" class="btn btn-success">Install Image</button>
    </div>
    <div style="visibility:hidden" id="notify">
    <h3 style="color:orange">Please wait image Upgrade has started....</h3>
    </div>
</div>

<hr>

<div id="image_div" class="container text-center">
   
   
   
   <table id="table1" border="1" style="height:50px;width: 1002px;margin-top: 20px;">
           
	   <tr bgcolor="#343a40" >
	   <th style="width:172px;"><font color="white" style="font-weight:1000" >Action</font></th>
	   <th style="width:162px;"><font color="white" style="font-weight:1000" > IP</font></th>
       <th><font color="white" style="font-weight:1000" >Password</font></th>
	   <th><font color="white" style="font-weight:1000"> Platform</font></th>
	   <th style="width:300px;" ><font color="white" style="font-weight:1000" > Status</font> </th>
	   <th><font color="white" style="font-weight:1000" > (Pass/Fail)</font></th>
       </tr>
       </table>
    


  </div>
 </body> 
<script>

function sleep (time) {
	  return new Promise((resolve) => setTimeout(resolve, time));
	}
$("#table1").on('click', '.remove-officer-button', function(e) {
    var whichtr = $(this).closest("tr");

    // Alert does not work
    whichtr.remove();      
});
function addRow() {
	   "use strict";

	    var table = document.getElementById("table1");
	    
	    var row= document.createElement("tr");
	    var td1_1 = document.createElement("td");
	        var td1 = document.createElement("td");
		    var td2 = document.createElement("td");
		        var td3 = document.createElement("td");    
                      var td4 = document.createElement("td");
	                 var td5 = document.createElement("td");
	                
	                
	              
	               var ip=document.getElementById("deviceIpAddress").value;
	            td1_1.innerHTML="<button class='remove-officer-button' border=3 height=20 width=30>Delete row</button>"
			    td1.innerHTML =ip;
			    var ip1=ip+"_type";
			    var ip2=ip+"_status";
			    var ip3=ip+"_pass";
			    td2.innerHTML  = document.getElementById("password").value;
			    var e = document.getElementById("deviceType");
			    var selectedIP = e.options[e.selectedIndex].text;        
	    td3.innerHTML=selectedIP;
	    row.appendChild(td1_1);
	    row.appendChild(td1);
	    row.appendChild(td2);
	    row.appendChild(td3);
	    
	    
	    td4.innerHTML=" ";
	    td5.innerHTML=" ";
	    td4.setAttribute('id', ip2);
	    td5.setAttribute('id', ip3);
	    row.appendChild(td4);
	    row.appendChild(td5); 
	    table.children[0].appendChild(row);

};

function pool_status(){
	var ip_add="";
	sleep(18000).then(() => {
		 var table = document.getElementById("table1");
		 
	     for (var i = 1 ; i < table.rows.length; i++) {

	         var row = "";

	         for (var j =1; j < 2; j++) {

	             row += table.rows[i].cells[j].innerHTML;
	             var val=table.rows[i].cells[j].innerHTML;
	             
	             if(j==1){
	            	 ip_add=val;
	                            	 
	              }
	         }
	         $.ajax({
	             type:"GET",
	             url:"./php/status.php",
	             dataType: "json",
	             data:{
	                  ip:ip_add
	                  },
	             success: function(data){
	            	       var res = data.split(",");
	            	       document.getElementById(res[0]).innerHTML = res[1];          
	            	     },
	  		     error: function() { 
	                  	  total_status=ip+"_pass";
	  		            	  document.getElementById(total_status).innerHTML = "Failed to Fetch STATUS";   
	                    }          
	                        
	                            
	  	    });
	     }
	
	});
}
	 
	

 function image_upgrade(){
	 document.getElementById("up").style.visibility = "hidden";
	 document.getElementById("dev_btn").style.visibility = "hidden";
	 document.getElementById("notify").style.visibility = "visible";
	
	 var table = document.getElementById("table1");
	 
     for (var i = 1 ; i < table.rows.length; i++) {

         var row = "";

         for (var j =0; j < table.rows[i].cells.length; j++) {

             row += table.rows[i].cells[j].innerHTML;
             var val=table.rows[i].cells[j].innerHTML;
             
             if(j==1){
            	 var ip=val;
            	 
             }
             if(j==2){
            	 var password=val
             }
             if(j==3) {
            
                 var platform =val;
                 
             }
         
          
            	
            	 
     
             row += " | ";
         }
         var build=document.getElementById("build").value;
         var imagetype=document.querySelector('input[name="imageType"]:checked').value;
         var branch_name=document.querySelector('input[name="branchName"]:checked').value;
         var reset=document.querySelector('input[name="resetFactoryAll"]:checked').value;
         var payload={};
         payload.ip=ip;
         password=password.split("!").join("ex_cli");
         payload.pass=password;
         payload.buildId=build;
         payload.branch_name=branch_name;
         payload.platform=platform;
         payload.reset=reset;
         payload.imagetype=imagetype;
         payload=JSON.stringify(payload);
         console.log(payload);
         const interval = setInterval(function() {
        	   // method to be executed;
        	 pool_status();
        	 }, 5000);
         
         $.ajax({
             type:"GET",
             url:"./php/upgrade.php",
             dataType: "json",
             data:{
                  payload:payload
                  },
             success: function(data){
            	 
            	      data=JSON.parse(data);             
            	      var res = data.split(",");
            	      if(res[1]=="Pass"){
	            	       document.getElementById(res[0]).innerHTML="<img src='res/pass.jpg'  class='pass-officer-button' border=3 height=20 width=30></img>"   
	            	       }
            	      else {
  		              document.getElementById(res[0]).innerHTML = res[1];       
            	      }
                        
                     },
             error: function() { 
                	   total_status=ip+"_pass";
		            	  document.getElementById(total_status).innerHTML = "Failed";   
                  }          
                  
  	    });
        //console.log(row);
        
        
     }
	 
	 
 }
</script>  

</html>
